# caas

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image323.png?raw=true)

Truy cập trang web:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image324.png?raw=true)

Nội dung file `index.js` được tải về:

    const express = require('express');
    const app = express();
    const { exec } = require('child_process');

    app.use(express.static('public'));

    app.get('/cowsay/:message', (req, res) => {
    exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
        if (error) return res.status(500).end();
        res.type('txt').send(stdout).end();
    });
    });

    app.listen(3000, () => {
    console.log('listening');
    });

Đoạn code này chạy một ứng dụng web đơn giản. Mục đích là cung cấp endpoint `/cowsay/:message` để chạy câu lệnh `cowsay` trong hệ thống và trả về kết quả.

Tôi thử request `https://caas.mars.picoctf.net/cowsay/{message}`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image325.png?raw=true)

Đối với cowsay, đây là một phần mềm mã nguồn mở, có thể chạy thông qua giao diện dòng lệnh. Vì là giao diện dòng lệnh, việc sử dụng ký tự `&` để nối 2 câu lệnh là có thể.

Tôi thử truy cập `https://caas.mars.picoctf.net/cowsay/wow&id`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image326.png?raw=true)

=> Thành công in ra `id`. Từ đây tôi có thể lấy được flag:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image327.png?raw=true)

