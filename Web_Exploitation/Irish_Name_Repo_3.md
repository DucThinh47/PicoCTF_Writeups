# Irish-Name-Repo 3
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image43.png?raw=true)

### Web page
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image44.png?raw=true)

### Solution

Xem source page: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image45.png?raw=true)

Thử truy cập **/irish**:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image46.png?raw=true)

Không truy cập được. 

Click vào xem page Admin Login: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image47.png?raw=true)

Nhập password là **admin** và Intercept request này trong Burp Suite: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image48.png?raw=true)

=> Tìm được tham số **debug** có giá trị là 0, thử thay giá trị thành 1 và send request: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image49.png?raw=true)

=> Tìm được SQL query mà server dùng để xác thực thông tin log in. Đồng thời thấy được password **admin** vừa nhập đã được mã hóa thành **nqzva**. 

=> Để có thể sử dụng SQLi payload để bypass login, cần phải tìm ra quy tắc mã hóa và mã hóa payload ngay từ khi nhập password, khi đó server sẽ mã hóa lại lần nữa và ra được bản gốc của payload. 

Thử nhập 1 password dài hơn: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image50.png?raw=true)

Có vẻ các ký tự trong chuỗi mã hóa cách ký tự gốc một số khoảng cách cố định trong bảng chữ cái. Dựa vào bảng chữ cái tiếng Anh: a -> n, b -> o,... cho thấy mỗi ký tự được thay thế bằng ký tự cách nó 13 vị trí trong bảng chữ cái. Đây là quy tắc của mã hóa **ROT13** (rotate by 13 places).

Sử dụng payload **' OR '1'='1**, được mã hóa theo quy tắc **ROT13** thành **' BE '1'='1**. Nhập payload vào password và send request: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image51.png?raw=true)

**Flag: picoCTF{3v3n_m0r3_SQL_7f5767f6}**
