# Who are you?
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image185.png?raw=true)

### Web page
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image186.png?raw=true)

### Solution

Xem source page:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image187.png?raw=true)

=> Không tìm được thông tin hữu ích. 

Web page hiển thị một thông báo **Only people who use the official PicoBrowser are allowed on this site!**. Có vẻ liên quan đến **Request Header Field**.

Mở Burp Suite và Intercept request refresh page: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image188.png?raw=true)

**User-Agent** header được dùng để mô tả về client đang gửi request, 1 số thông tin được mô tả như browser, application, bot, OS,.... Thử thêm **PicoBrowser** vào **User-Agent** header và send Request: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image189.png?raw=true)

=> Nhận được gợi ý mới từ server: **I don't trust users visiting from another site**.

Có vẻ liên quan đến **Referer** header. Header này dùng để cho web server biết **trang web nào đã dẫn người dùng đến trang hiện tại**, giúp server biết nguồn gốc của request, như trang web trước đó mà user đã truy cập. Ví dụ: nếu người dùng nhấp vào 1 link từ website example.com để đến yourwebsite.com, server của yourwebsite.com sẽ nhận được thông tin rằng request đến từ example.com.

Thử thêm **Referer** header vào request với giá trị là **http://mercury.picoctf.net:52362/** - chính là web page hiện tại:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image190.png?raw=true)

Request lúc này sẽ trở thành:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image191.png?raw=true)

Send request này và xem response là gì: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image192.png?raw=true)

=> Nhận được gợi ý mới từ server: **Sorry, this site only worked in 2018..** Thông báo này có vẻ liên quan đến **Date** header. Thử thêm **Date** header vào request với value là **2018**:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image193.png?raw=true)

Request lúc này trở thành: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image194.png?raw=true)

Send request này và xem response là gì: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image195.png?raw=true)

=> Nhận được gợi ý mới từ server: **I don’t trust users who can be tracked**. Có vẻ liên quan đến **DNT** header. Để không bị theo dõi (tracked) khi sử dụng HTTP, có thể sử dụng **DNT** header để tắt tính năng theo dõi trong Request. Thử thêm **DNT** header vào request với **value=1**:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image196.png?raw=true)

Send request này và xem response là gì: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image197.png?raw=true)

=> Nhận được gợi ý mới từ server: **This website is only for people from Sweden**. Có vẻ liên quan đến **X-Forwarded-For** header. Header này được dùng để chỉ định rằng website này **đến từ 1 vị trí cụ thể**. Thử thêm **X-Forwarded-For** header vào request với value là **1 địa chỉ IP đến từ Sweden**:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image198.png?raw=true)

Send request này và xem response là gì: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image199.png?raw=true)

=> Nhận được gợi ý mới từ server: **You are in Sweden but you don’t speak Swedish?**. Có vẻ liên quan đến **Accept-Language** header, header này **chỉ định ngôn ngữ nào được accept** đối với website. Thử thêm mã ngôn ngữ Swedish vào header này:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image200.png?raw=true)

Send request này và xem response là gì:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image201.png?raw=true)

**Flag: picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_0c0db339}**



