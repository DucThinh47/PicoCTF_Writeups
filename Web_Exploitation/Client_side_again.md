# Client-side-again
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image4.png?raw=true)

### Solution

Xem source page: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image5.png?raw=true)

Tìm được đoạn Javascript có nội dung: 

*var _0x5a46=['0a029}','_again_5','this','Password\x20Verified','Incorrect\x20password','getElementById','value','substring','picoCTF{','not_this'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822'push';}};_0xb4bdb3(++_0x2bd6f7);}(_0x5a46,0x1b3));var _0x4b5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x5a46[_0x2d8f05];return _0x4d74cb;};function verify(){checkpass=document_0x4b5b('0x0')[_0x4b5b('0x1')];split=0x4;if(checkpass_0x4b5b('0x2')==_0x4b5b('0x3')){if(checkpass_0x4b5b('0x2')=='{n'){if(checkpass_0x4b5b('0x2')==_0x4b5b('0x4')){if(checkpass_0x4b5b('0x2')=='oCT'){if(checkpass_0x4b5b('0x2')==_0x4b5b('0x5')){if(checkpass'substring'=='F{not'){if(checkpass_0x4b5b('0x2')==_0x4b5b('0x6')){if(checkpass_0x4b5b('0x2')==_0x4b5b('0x7')){alert(_0x4b5b('0x8'));}}}}}}}}else{alert(_0x4b5b('0x9'));}}*

Code đã bị *obfuscate*, sử dụng tool online, format lại code giúp dễ đọc hơn: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image6.png?raw=true)

Nhìn qua code có thể thấy đoạn code đang ẩn chứa flag, các phần của flag nằm rải rác trong code, cần tìm và ghép lại.

1. Mảng **_0x5a46**:

        var _0x5a46 = ['0a029}', '_again_5', 'this', 'Password Verified', 'Incorrect password', 'getElementById', 'value', 'substring', 'picoCTF{', 'not_this'];

    Mảng **_0x5a46** chứa các chuỗi quan trọng: 

    - **picoCTF{**: Phần đầu của flag (index 8).

    - **not_this**: Phần giữa (index 9).

    - **_again_5**: Phần tiếp theo (index 1).

    - **0a029}**: Phần cuối (index 0).

2. Hàm **_0x4b5b**:

        var _0x4b5b = function (_0x2d8f05, _0x4b81bb){
            _0x2d8f05 = _0x2d8f05 - 0x0;
            var _0x4d74cb = _0x5a46[_0x2d8f05];
            return _0x4d74cb;
        };

    Hàm này trả về giá trị từ mảng **_0x5a46** dựa trên index được truyền vào:

    Ví dụ: 

    - **_0x4b5b('0x8')** trả về **picoCTF{**.

    - **_0x4b5b('0x9')** trả về **not_this**.

    - **_0x4b5b('0x1')** trả về **_again_5**.

    - **_0x4b5b('0x0')** trả về **0a029}**.

3. Hàm **verify**:

        function verify() {
            checkpass = document[_0x4b5b('0x5')]('0x0')[_0x4b5b('0x6')];
            split = 0x4;
            if (checkpass[_0x4b5b('0x7')](0x0, 0x4) == _0x4b5b('0x3')) {
                if (checkpass[_0x4b5b('0x7')](0x4, 0x8) == '{n') {
                    if (checkpass[_0x4b5b('0x7')](0x8, 0xc) == _0x4b5b('0x4')) {
                        if (checkpass[_0x4b5b('0x7')](0xc, 0x10) == 'oCT') {
                            if (checkpass[_0x4b5b('0x7')](0x10, 0x14) == _0x4b5b('0x5')) {
                                if (checkpass[_0x4b5b('0x7')](0x14, 0x18) == 'F{not') {
                                    if (checkpass[_0x4b5b('0x7')](0x18, 0x1c) == _0x4b5b('0x6')) {
                                        if (checkpass[_0x4b5b('0x7')](0x1c, 0x20) == _0x4b5b('0x7')) {
                                            alert(_0x4b5b('0x8'));
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            } else {
                alert(_0x4b5b('0x9'));
            }
        }

    Hàm này kiểm tra mật khẩu nhập vào (checkpass) bằng cách so sánh từng phần của nó với các giá trị trong mảng.


Từ các điều kiện trên và mảng _0x5a46, có thể ghép các phần của flag lại:

- **picoCTF{** (từ mảng _0x5a46).

- **not_this** (từ mảng _0x5a46).

- **_again_5** (từ mảng _0x5a46).

- **0a029}** (từ mảng _0x5a46).

**Flag: picoCTF{not_this_again_50a029}**