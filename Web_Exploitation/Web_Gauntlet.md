# Web Gauntlet

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image349.png?raw=true)

Truy cập trang web:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image350.png?raw=true)

Kiểm tra file `filter.php` được cung cấp bởi thử thách:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image351.png?raw=true)

Dựa vào nội dung file `filter.php`, tôi thử chèn sqli payload, nhưng không dùng `OR`, khi tôi nhập `admin:admin'--`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image352.png?raw=true)

=> Tôi đã tìm ra câu lệnh SQL mà website dùng để xác thực user:

    SELECT * FROM users WHERE username='admin' AND password='admin'--

Tiếp theo tôi đã thử `admin' --:<blank>`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image353.png?raw=true)

Sang đến round 2, tôi kiểm tra file `filter.php`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image354.png?raw=true)

Ở round 2, tôi không thể dùng `or`, `and`, `like`, `=` và `--`. Ý tưởng của tôi là sử dụng `multi-comment`: `/*`. Tôi thử nhập `admin'/*:1`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image355.png?raw=true)

Sang tới round 3, nội dung `filter.php` sẽ là:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image356.png?raw=true)

Lần này, không thể dùng `OR`, `AND`, `=`, `LIKE`, `<`, `>` và `--`. Tiếp tục sử dụng lại payload ở round 2 và tôi đã bước sang round 4:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image357.png?raw=true)

Nội dung file `filter.php` lần này sẽ là:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image358.png?raw=true)

Do `admin` bị lọc, ý tưởng của tôi là tách từ `admin` ra, sử dụng `ad'||'min'/*:1`:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image359.png?raw=true)

Sang round 5, nội dung filter lúc này là:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image360.png?raw=true)

Sử dụng lại payload từ round 4 và tôi thành công lấy được flag:

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image361.png?raw=true)

![img](https://github.com/DucThinh47/PicoCTF_Writeups/blob/main/Web_Exploitation/images/image362.png?raw=true)

